import{r as c,j as e,m as r}from"./index-CUOHatz0.js";import{u as T,a as I,o as E,s as y}from"./schemas-Bw3N84gd.js";import{a as L,b as V}from"./useAuth-DavIqWaB.js";import{A as l}from"./AuthLayout-D7woBCdN.js";import{B as m}from"./Button-B0yPuW82.js";import{I as b}from"./Input-oOn517Ah.js";import{T as R}from"./triangle-alert-xK5iUhvB.js";import{C as A}from"./circle-check-big-C3qhY9i8.js";import{L as j}from"./lock-C3Dw2yxF.js";import"./GlassCard-D31sd0LJ.js";import"./createLucideIcon-416et06r.js";import"./eye-BHY9pgk7.js";const B=E({newPassword:y().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain at least one uppercase letter").regex(/[a-z]/,"Password must contain at least one lowercase letter").regex(/\d/,"Password must contain at least one number").regex(/[!@#$%^&*(),.?":{}|<>]/,"Password must contain at least one special character"),confirmPassword:y().min(1,"Please confirm your password")}).refine(a=>a.newPassword===a.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),K=({token:a="demo-token"})=>{const[u,d]=c.useState(null),{resetPassword:P,isLoading:o,error:n,isSuccess:v,clearError:w}=L(),{register:x,handleSubmit:N,formState:{errors:p,isValid:k},watch:h}=T({resolver:I(B),mode:"onChange",defaultValues:{newPassword:"",confirmPassword:""}}),f=h("newPassword"),s=V(f);c.useEffect(()=>{(async()=>{if(!a){d(!1);return}try{await new Promise(t=>setTimeout(t,1e3)),d(!0)}catch{d(!1)}})()},[a]);const S=h();c.useEffect(()=>{n&&w()},[S,n,w]);const C=async i=>{try{await P({token:a,newPassword:i.newPassword,confirmPassword:i.confirmPassword})}catch(t){console.error("Password reset failed:",t)}},g=()=>{console.log("Navigate back to login")};return u===null?e.jsx(l,{title:"Validating Reset Link",subtitle:"Please wait while we verify your reset token",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin mx-auto w-8 h-8 border-2 border-primary-500 border-t-transparent rounded-full mb-4"}),e.jsx("p",{className:"text-neutral/70 text-sm",children:"Validating your reset link..."})]})}):u?v?e.jsx(l,{title:"Password Reset Successful",subtitle:"Your password has been successfully updated",children:e.jsxs(r.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"text-center space-y-6",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-green-500/10 rounded-full flex items-center justify-center",children:e.jsx(A,{className:"h-8 w-8 text-green-500"})}),e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-neutral text-sm",children:"Your password has been successfully reset. You can now sign in with your new password."})}),e.jsx(m,{variant:"primary",fullWidth:!0,onClick:g,children:"Continue to Sign In"})]})}):e.jsx(l,{title:"Set New Password",subtitle:"Enter your new password below",children:e.jsxs("form",{onSubmit:N(C),className:"space-y-6",children:[n&&e.jsx(r.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-4 bg-red-500/10 border border-red-500/20 rounded-lg",children:e.jsx("p",{className:"text-red-500 text-sm",children:n})}),e.jsxs("div",{children:[e.jsx(b,{...x("newPassword"),type:"password",label:"New Password",placeholder:"Enter your new password",leftIcon:e.jsx(j,{className:"h-4 w-4"}),showPasswordToggle:!0,error:p.newPassword?.message,disabled:o,autoComplete:"new-password",autoFocus:!0}),f&&e.jsxs(r.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"flex-1 bg-surface rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-300 ${s.score<=1?"bg-red-500 w-1/4":s.score<=2?"bg-yellow-500 w-2/4":s.score<=3?"bg-blue-500 w-3/4":"bg-green-500 w-full"}`})}),e.jsx("span",{className:`text-xs font-medium ${s.score<=1?"text-red-500":s.score<=2?"text-yellow-500":s.score<=3?"text-blue-500":"text-green-500"}`,children:s.score<=1?"Weak":s.score<=2?"Fair":s.score<=3?"Good":"Strong"})]}),s.feedback.length>0&&e.jsx("ul",{className:"text-xs text-neutral/70 space-y-1",children:s.feedback.map((i,t)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-1 h-1 bg-neutral/50 rounded-full"}),i]},t))})]})]}),e.jsx("div",{children:e.jsx(b,{...x("confirmPassword"),type:"password",label:"Confirm New Password",placeholder:"Confirm your new password",leftIcon:e.jsx(j,{className:"h-4 w-4"}),showPasswordToggle:!0,error:p.confirmPassword?.message,disabled:o,autoComplete:"new-password"})}),e.jsx(m,{type:"submit",variant:"primary",size:"lg",fullWidth:!0,disabled:!k||o||!s.isValid,loading:o,children:o?"Updating Password...":"Update Password"}),e.jsx("div",{className:"mt-6 p-4 bg-surface/50 border border-glass-border rounded-lg",children:e.jsx("p",{className:"text-xs text-neutral/70 text-center",children:"After updating your password, you'll be automatically signed out of all devices and need to sign in again."})})]})}):e.jsx(l,{title:"Invalid Reset Link",subtitle:"This password reset link is invalid or has expired",children:e.jsxs(r.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"text-center space-y-6",children:[e.jsx(r.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"mx-auto w-20 h-20 bg-red-500/20 backdrop-blur-sm rounded-2xl flex items-center justify-center border border-red-500/30",children:e.jsx(R,{className:"h-10 w-10 text-red-400"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-white text-base font-medium",children:"The password reset link you clicked is either invalid or has expired."}),e.jsx("p",{className:"text-neutral/80 text-sm leading-relaxed",children:"Password reset links are valid for 1 hour from the time they are sent."})]}),e.jsx(r.div,{whileHover:{scale:1.02},children:e.jsx(m,{variant:"primary",fullWidth:!0,size:"lg",onClick:g,className:"bg-gradient-to-r from-primary to-primary-hover hover:shadow-lg hover:shadow-primary/25",children:"Back to Sign In"})}),e.jsx(r.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6},className:"mt-6 p-4 bg-surface/30 backdrop-blur-sm border border-glass-border rounded-xl",children:e.jsx("p",{className:"text-xs text-neutral/80 text-center leading-relaxed",children:"If you need to reset your password, please request a new reset link from the sign-in page."})})]})})};export{K as ResetPasswordPage,K as default};
